<sly data-sly-template.accordion_template="${@data, flag}">

  <div class="pw-container" data-module="Accordion">
    <div class="tp-accordion pw-padding--regular pw-margin--regular pw-theme--grayscale-white cmp-accordion"
      id="accordion_${resource.path.hashCode}" data-panelcontainer="${wcmmode.edit && 'accordion'}"
      data-cmp-is="accordion" data-cmp-data-layer="${data.data.json}"
      data-cmp-single-expansion="${data.singleExpansion}"
      data-placeholder-text="${wcmmode.edit && 'Please drag Accordion item components here' @ i18n}">
      <h2 class="tp-accordion__heading" data-sly-test="${data.heading}"> ${data.heading}</h2>
      <p class="tp-accordion__description" data-sly-test="${data.description}"> ${data.description}</p>

      <div class="tp-accordion__events accordion">
        <sly data-sly-list.tab="${data.items}">
          <sly data-sly-test="${tab.title}">
            <button type="button" class="tp-accordion__event js-accordion__event collapsed" data-toggle="collapse"
              data-target="#collapse_${tabList.index}_${resource.path.hashCode}" data-index="${tabList.index}"
              aria-expanded="${tabList.index == 0 ? 'true' : 'false'}" aria-controls="collapse_${tabList.index}">
              <div class="tp-accordion__event-title">${tab.title @i18n,locale=data.locale}</div>
              <i class="icon icon-Arrow_Right_pw"></i>
            </button>

            <sly data-sly-test.accordionID="collapse_${tabList.index}_${resource.path.hashCode}" />
            <div id="${!wcmmode.edit && accordionID}" class="${!wcmmode.edit ? 'tp-accordion-detail-wrapper collapse':''}">
              <div class="tp-accordion-detail" data-link-parent-title="${tab.title @i18n,locale=data.locale}">
                <div class="tp-accordion__event-detail-description">
                  <div data-sly-resource="${tab.name @ decorationTagName='div'}" data-cmp-hook-accordion="panel"
                    id="${item.id}-panel" role="region" aria-labelledby="${tab.id}-button">
                  </div>
                </div>
              </div>
            </div>
          </sly>
        </sly>
      </div>
    </div>

    <sly
      data-sly-resource="${resource.path @ resourceType='wcm/foundation/components/parsys/newpar', appendPath='/*', decorationTagName='div', cssClassName='new section aem-Grid-newComponent'}"
      data-sly-test="${(wcmmode.edit || wcmmode.preview) && data.items.size < 4}"></sly>
  </div>
</sly>